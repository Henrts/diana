import { Meta, Story, Preview } from "@storybook/addon-docs/blocks";
import * as yup from "yup";
import { Form, FormStory } from "./Form.story";
import ErrorTextInput from "../TextInput/ErrorTextInput";
import Checkbox from "../Checkbox/Checkbox";
import BaseButton from "../Button/BaseButton";

<Meta title="Components | Form" />

# Form

`Form` is a wrapper for all form dependent behavior, handling validation and field value changes. Displaying error messages is the responsability of the parts used in the composition as children of the form.

<Preview>
  <Story name="Simple Form">
    <Form
      schema={yup.object().shape({
        username: yup.string().required("Username is required"),
        password: yup
          .string()
          .required("Password is required")
          .min(12, "Password is too small")
      })}
      onSubmitFunc={e => console.log(e)}
    >
      <ErrorTextInput label="Username" name="username" type="text" />
      <ErrorTextInput label="Password" name="password" type="password" />
      <Checkbox name="remember">Remember me</Checkbox>
      <BaseButton type="submit">Submit</BaseButton>
    </Form>
  </Story>
</Preview>

<table width="100%">
  <thead>
    <tr>
      <th>Prop</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>schema</td>
      <td>
        If you would like to centralize your validation rules with external
        validation schema
      </td>
    </tr>
    <tr>
      <td>onSubmit</td>
      <td>Callback for a successful (no errors) submission of the form</td>
    </tr>
  </tbody>
</table>

#### Extendable styles

<table width="100%">
  <thead>
    <tr>
      <th>Style Name</th>
      <th>@selectors</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>form</td>
      <td></td>
      <td>
        This style affects the main container element that contains all the
        children fields and inputs of the form
      </td>
    </tr>
  </tbody>
</table>

### Using yup for validation

[yup](https://github.com/jquense/yup) supports the definition of a validation Schema where we can define several rules for each field of the form.
We can also use yup to transform values to match a rule, like trimming and uppercasing fields

#### Example schema

```javascript
{
    "username": yup.string().trim().required("Missing username!"),
    "email": yup.string().email("Must be an email!"),
    "age": yup.number().min(18, "Minimum age is 18")
    "password": yup.string().required("Password is required").min(12, "Password is too small")
}
```

<table width="100%">
  <thead>
    <tr>
      <td>Component</td>
      <td>Supported</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>TextInput</td>
      <td>
        <strong>x</strong>
      </td>
    </tr>
    <tr>
      <td>ErrorTextInput</td>
      <td>
        <strong>x</strong>
      </td>
    </tr>
    <tr>
      <td>Checkbox</td>
      <td>
        <strong>x</strong>
      </td>
    </tr>
  </tbody>
</table>
